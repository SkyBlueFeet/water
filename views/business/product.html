<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>产品清单 | <%= title %></title>
    <%- include("../partials/_meta.html")  %>
    <link rel="canonical" href="https://v4.bootcss.com/docs/examples/album/">

    <%- include("../partials/public.css.html")  %>

    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }

        .jumbotron {
            padding-top: 3rem;
            padding-bottom: 3rem;
            margin-bottom: 0;
            background-color: #fff;
        }

        @media (min-width: 768px) {
            .jumbotron {
                padding-top: 6rem;
                padding-bottom: 6rem;
            }
        }

        .jumbotron p:last-child {
            margin-bottom: 0;
        }

        .jumbotron h1 {
            font-weight: 300;
        }

        .jumbotron .container {
            max-width: 40rem;
        }

        footer {
            padding-top: 3rem;
            padding-bottom: 3rem;
        }

        footer p {
            margin-bottom: .25rem;
        }

        .product-head {
            height: 3rem;
            line-height: 3rem;
        }


        /* GLOBAL STYLES-------------------------------------------------- */
        /* Padding below the footer and lighter body text */

        body {
            padding-top: 3rem;
            padding-bottom: 3rem;
            color: #5a5a5a;
        }


        /* CUSTOMIZE THE CAROUSEL
-------------------------------------------------- */

        /* Carousel base class */
        .carousel {
            margin-bottom: 4rem;
        }

        /* Since positioning the image, we need to help out the caption */
        .carousel-caption {
            bottom: 3rem;
            z-index: 10;
        }

        /* Declare heights because of positioning of img element */
        .carousel-item {
            height: 32rem;
        }

        .carousel-item>img {
            position: absolute;
            top: 0;
            left: 0;
            min-width: 100%;
            height: 32rem;
        }


        /* MARKETING CONTENT
-------------------------------------------------- */

        /* Center align the text within the three columns below the carousel */
        .marketing .col-lg-4 {
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .marketing h2 {
            font-weight: 400;
        }

        .marketing .col-lg-4 p {
            margin-right: .75rem;
            margin-left: .75rem;
        }


        /* Featurettes------------------------- */

        .featurette-divider {
            margin: 5rem 0;
            /* Space out the Bootstrap <hr> more */
        }

        /* Thin out the marketing headings */
        .featurette-heading {
            font-weight: 300;
            line-height: 1;
            letter-spacing: -.05rem;
        }


        /* RESPONSIVE CSS-------------------------------------------------- */

        @media (min-width: 40em) {

            /* Bump up size of carousel content */
            .carousel-caption p {
                margin-bottom: 1.25rem;
                font-size: 1.25rem;
                line-height: 1.4;
            }

            .featurette-heading {
                font-size: 50px;
            }
        }

        @media (min-width: 62em) {
            .featurette-heading {
                margin-top: 7rem;
            }
        }

        .message-box {
            position: fixed;
            z-index: 10;
            top: 10%;
            right: 1%;
        }
    </style>
</head>

<body>
    <div id="app">
        <%- include("../partials/_header.html")  %>
        <main role="main">
            <!-- 头部 -->
            <div id="myCarousel" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                    <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                    <li data-target="#myCarousel" data-slide-to="1"></li>
                    <li data-target="#myCarousel" data-slide-to="2"></li>
                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg"
                            preserveAspectRatio="xMidYMid slice" focusable="false" role="img">
                            <rect width="100%" height="100%" fill="#777" /></svg>
                        <div class="container">
                            <div class="carousel-caption text-left">
                                <h1>Example headline.</h1>
                                <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi
                                    porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.
                                </p>
                                <p><a class="btn btn-lg btn-primary" href="#" role="button">Sign up today</a></p>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg"
                            preserveAspectRatio="xMidYMid slice" focusable="false" role="img">
                            <rect width="100%" height="100%" fill="#777" /></svg>
                        <div class="container">
                            <div class="carousel-caption">
                                <h1>Another example headline.</h1>
                                <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi
                                    porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.
                                </p>
                                <p><a class="btn btn-lg btn-primary" href="#" role="button">Learn more</a></p>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg"
                            preserveAspectRatio="xMidYMid slice" focusable="false" role="img">
                            <rect width="100%" height="100%" fill="#777" /></svg>
                        <div class="container">
                            <div class="carousel-caption text-right">
                                <h1>One more for good measure.</h1>
                                <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi
                                    porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.
                                </p>
                                <p><a class="btn btn-lg btn-primary" href="#" role="button">Browse gallery</a></p>
                            </div>
                        </div>
                    </div>
                </div>
                <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
            <div class="message-box"> </div>

            <!-- 产品分类 -->
            <div class="album py-5 bg-light">
                <div class="container">
                    <div class="row product-head">
                        <div class="col-6 col-md-10">
                            现有产品
                        </div>
                        <div class="col-6 col-md-2">
                            <a href="/business/cart" class="btn btn-link ">
                                前往购物车({{ cartNum }})
                            </a>
                        </div>
                    </div>
                    <hr />
                    <div class="row">
                        <template v-for="(item,key) in productList">
                            <div class="col-md-4" :index="key" :id="item.id">
                                <div class="card mb-4 shadow-sm">
                                    <img :src="item.banner" width="100%" height="225" />
                                    <div class="card-body">
                                        <h5 class="text-danger">￥{{item.price}}</h5>
                                        <p class="card-text">{{item.description}}</p>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <small class="text-info">规格: {{item.specification}}</small>
                                            <div class="btn-group">
                                                <button @click="addCart(item)" type="button"
                                                    class="btn btn btn-outline-success">
                                                    <i class="iconfont">&#xe61e; </i>
                                                    添加到购物车
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </main>

        <%- include("../partials/_footer.html")  %>
    </div>
    <script src="/public/js/jquery.min.js"></script>
    <script src="/public/js/bootstrap.min.js"></script>
    <script src="/public/js/vue<%= isProd?'.min':'' %>.js"></script>
    <script>
        var vm = new Vue({
            el: "#app",
            data() {
                return {
                    alertStyle: "alert-<%= data.status %>",
                    alertShow: "<%= data.status %>" === "success",
                    productStr: ('<%-data.list %>'),
                    cartNum: 0,
                    cartList: {},
                    path: ""
                }
            },
            created() {
                var path = window.location.pathname.split('/');
                path[path.length - 1] ? void (0) : path.pop();
                this.path = path.join("/");
                if (localStorage.getItem("cartList")) {
                    var cartList = JSON.parse(localStorage.getItem("cartList"));
                    var keys = Object.keys(cartList);
                    for (var i = 0, len = keys.length; i < len; i++) {
                        this.cartNum += cartList[keys[i]].num;
                    }
                    this.cartList = cartList;
                }
            },
            methods: {
                hideAlert() {
                    this.alertShow = false
                },
                addCart(item) {
                    var rid = `message${Math.floor(Math.random() * 10000)}`;
                    var message = `<div id="${rid}" class="alert alert-success" role="alert"><strong>${item.title}</strong> 已添加到购物车！</div>`;
                    $(".message-box").append(message);
                    setTimeout(function () {
                        $("#" + rid).remove();
                    }, 3000)
                    if (this.cartList[item.pid]) {
                        this.cartList[item.pid].num++
                    } else {
                        this.cartList[item.pid] = { num: 0, item: {} };
                        this.cartList[item.pid].num = 1;
                        this.cartList[item.pid].item = item;
                    }
                    window.localStorage.setItem("cartList", JSON.stringify(this.cartList));
                    this.cartNum++;
                }
            },
            computed: {
                productList() {
                    return JSON.parse(this.productStr)
                }
            }
        })
    </script>
</body>

</html>